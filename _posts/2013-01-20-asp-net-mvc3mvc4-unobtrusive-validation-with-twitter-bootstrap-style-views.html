---
layout: post
title: ASP.NET MVC3/MVC4 Unobtrusive Validation with Twitter Bootstrap style views
date: 2013-01-20 18:09:06.000000000 -05:00
type: post
published: true
status: publish
categories:
- Tweaks
tags:
- ASP.NET
- ASP.NET MVC
- control group
- jQuery Unobtrusive Validation
- jQuery Validation
- Twitter Bootstrap
- Unobtrusive Validation
meta:
  _edit_last: '26965888'
  _publicize_pending: '1'
  tagazine-media: a:7:{s:7:"primary";s:60:"http://trialexpired.files.wordpress.com/2013/01/capture1.png";s:6:"images";a:2:{s:60:"http://trialexpired.files.wordpress.com/2013/01/capture1.png";a:6:{s:8:"file_url";s:60:"http://trialexpired.files.wordpress.com/2013/01/capture1.png";s:5:"width";i:563;s:6:"height";i:542;s:4:"type";s:5:"image";s:4:"area";i:305146;s:9:"file_path";b:0;}s:61:"http://trialexpired.files.wordpress.com/2013/01/capture21.png";a:6:{s:8:"file_url";s:61:"http://trialexpired.files.wordpress.com/2013/01/capture21.png";s:5:"width";i:679;s:6:"height";i:133;s:4:"type";s:5:"image";s:4:"area";i:90307;s:9:"file_path";b:0;}}s:6:"videos";a:0:{}s:11:"image_count";i:2;s:6:"author";s:8:"26965888";s:7:"blog_id";s:8:"31371023";s:9:"mod_stamp";s:19:"2013-01-20
    23:14:29";}
  twitter_cards_summary_img_size: a:6:{i:0;i:563;i:1;i:542;i:2;i:3;i:3;s:24:"width="563"
    height="542"";s:4:"bits";i:8;s:4:"mime";s:9:"image/png";}
author:
  login: neb85
  email: neb.trx@gmail.com
  display_name: Neb
  first_name: ''
  last_name: ''
---
<p><strong>Introduction</strong></p>
<p>If you're working with ASP.NET MVC3/MVC4 and you're opting to enhance your views with <a href="http://twitter.github.com/bootstrap/">Twitter Bootstrap</a>  front-end toolkit, which is an excellent tool  for rapidly developing web applications, you may encounter some obstacles in your way while enabling client side unobtrusive validation. As you may know this feature is achieve through  the co-op of two JavaScript plugins: <a href="http://docs.jquery.com/Plugins/Validation">jQuery Validation</a> and  <a href="http://nraykov.wordpress.com/2011/06/06/asp-net-mvc-3-unobtrusive-client-side-validation/">MVC 3 Unobtrusive jQuery Validation</a>.</p>
<p><strong>The real stuff. </strong></p>
<p>This is what you wanna get:</p>
<p><a id="desired" href="http://trialexpired.files.wordpress.com/2013/01/capture1.png"><img class="aligncenter size-full wp-image-45" alt="Desired Client Validation Behavior" src="{{ site.baseurl }}/assets/capture1.png" width="563" height="542" /></a></p>
<p><strong>The code</strong></p>
<p>In order to achieve that you may follow a couple of ways, but with the exception of modifying the CSS styles of the MVC 3 Unobtrusive jQuery Validation Plugin, most of them lead to the same end: modify the highlight/unhighlight handlers to obtain the desire effect. This is easy, but  first you have to layout the view using the <em>.control-group</em> and <em>.controls</em> style classes as the following example shows:</p>
<p><a href="http://trialexpired.files.wordpress.com/2013/01/capture21.png"><img class="aligncenter size-full wp-image-47" alt="Code Snippet" src="{{ site.baseurl }}/assets/capture21.png" width="645" height="126" /></a></p>
<p>Once did this for every form field you should proceed to write some jQuery code to ensure the label get the right style because the ASP.NET MVC3 Html.LabelFor helper wont let you add custom HTML attributes. So..</p>
<pre>$("#register-form .control-group&gt;label").addClass('control-label');</pre>
<p>Of course you may also write a custom Html helper to works out did for you.</p>
<p>Now you must code some JavaScript  to overwrite the default behavior of the jQuery Validation plugin in matters of highlight/highlight forms error:</p>
<pre>function boostrapHighlight(element, errorClass, validClass) {
     $(element).closest(".control-group").addClass("error");
     $(element).trigger('highlated');
};

function boostrapUnhighlight(element, errorClass, validClass) {
     $(element).closest(".control-group").removeClass("error");
     $(element).trigger('unhighlated');
};

$.validator.setDefaults({
     ignore: "",
     highlight: function (element, errorClass, validClass) {
          boostrapHighlight(element, errorClass, validClass);
     },
     unhighlight: function (element, errorClass, validClass) {
          boostrapUnhighlight(element, errorClass, validClass);
     }
});</pre>
<p>Voila!  it's done!. Now when the plugin desires to highlight an element it looks for the closest <em>.control-group </em>element and decorates it with the <em>.error</em> CSS class achieving the desire bootstrap style validation behavior. The unhighlight works similarly but in reverse.</p>
<p><strong>Further explanation</strong></p>
<p>In the previous code fragment there are a couple of stuff you may wonder why I did it.</p>
<p>The first, after highlighting every element I trigger an event named 'highlithed' and the same thing after unhighlighting which unleash the "unhighlithed" event. This statement allows me to triggers some particular behavior in the element which allows me for example: highlight the tab with errors in the form show in the <a href="#desired">image</a>. I got to say I've tried a cleaner approach to trigger customs behavior when a highlight occurs by using a Publisher-Subscriber Pattern to subscribe custom callbacks when these functions(highlight/unhighlight) were called but it turns out in a asynchronous mess when you a couple of forms in the same page. So in the end I prefer to use jQuery <a href="http://dailyjs.com/2009/11/14/jquery-custom-events/">custom events</a> which provide a built in means to use the publish subscribe pattern in a way that is functionally equivalent.</p>
<p>The second, when I override the defaults of the jQuery Validation Plugin I set the ignore property to none(""). This allows the validation to ignore none DOM elements and highlight/unhighlight even the hidden elements.</p>
<p><strong>Conclusions</strong></p>
<p>The integration of Twitter Bootstrap front end toolkit is an excellent choice to make cleaner layout of the view. Today we have learned that tweak the MVC 3 Unobtrusive jQuery Validation Plugin to work with Bootstrap validation styles it's really easy.</p>
